
var seaSide = [
createPoint(33.7609627529093, -118.23950822906488),
createPoint(33.76514592470526, -118.24017287457258),
createPoint(33.75950885221525, -118.25785399639875),
createPoint(33.74937546073221, -118.26892615521223),
createPoint(33.74916136207781, -118.26420546734602)
];

var harry = [
createPoint(33.769997791448844, -118.27845336163313),
createPoint(33.7706042554759, -118.27051202294905),
createPoint(33.768071347831125, -118.2651905202635),
createPoint(33.765716746815684, -118.26454679009993),
createPoint(33.76200633513638, -118.26973754675276),
createPoint(33.75683289690615, -118.27196914465316),
createPoint(33.75733241490496, -118.27394325048812),
createPoint(33.767108109780914, -118.27051002294905),
createPoint(33.766323241142, -118.27720481665023)
];

var pico = [
createPoint(33.77682918216392, -118.20863355422944),
createPoint(33.77096991553549, -118.22196658210748),
createPoint(33.768597556637154, -118.22036798553461),
createPoint(33.77347598272601, -118.20790199337739),
createPoint(33.775723354301164, -118.20807365475434)

]

var ferry = [
createPoint(33.748929421265665, -118.26956734304781),
createPoint(33.74835848736302, -118.26523289327974),
createPoint(33.748429854308725, -118.26441750173922),
createPoint(33.748715321497635, -118.26313004141207),
createPoint(33.74568218402487, -118.26154217367525),
createPoint(33.744754379372374, -118.2663057768857),
createPoint(33.74468300936799, -118.26669201498385),
createPoint(33.741756788053905, -118.26497540121431),
createPoint(33.739365777018, -118.27171311025972),
createPoint(33.73840221641706, -118.27222809439058),
createPoint(33.73640368585345, -118.27154144888277),
createPoint(33.73565422488922, -118.27265724783297),
createPoint(33.7355828473131, -118.2743738616025),
createPoint(33.74068619433744, -118.27476009970064)
];
var navywayIn = [
createPoint(33.74556620899212, -118.2453661735534),
createPoint(33.74544131262771, -118.24596698837274),
createPoint(33.73352179418946, -118.24270542221063),
createPoint(33.72881062971061, -118.25806911544794),
createPoint(33.72495584821085, -118.25515087203974),
createPoint(33.72417059371614, -118.25249012069696),
createPoint(33.72838232920512, -118.23849971847528),
createPoint(33.73355748384227, -118.2400875862121)
];
var navywayOut = [
createPoint(33.72881062971061, -118.25832660751337),
createPoint(33.72445614163633, -118.26201732711786),
createPoint(33.71667462106337, -118.25854118423456),
createPoint(33.71496116398435, -118.24716861801141),
createPoint(33.72313547454208, -118.23210533218378),
createPoint(33.733468259682404, -118.2399802978515),
createPoint(33.72834663739984, -118.23854263381952),
createPoint(33.724027819399794, -118.25261886672968)
];

var pierF = [
createPoint(33.762318515384784, -118.2066779907226),
createPoint(33.7624790647841, -118.20734317855829),
createPoint(33.75648501658039, -118.20787962036127),
createPoint(33.7525601151014, -118.2154327209472),
createPoint(33.746351267689285, -118.2156472976684),
createPoint(33.740141970742194, -118.20654924468988),
createPoint(33.74267570367027, -118.20680673675531),
createPoint(33.746922214955326, -118.21281488494867),
createPoint(33.75156102058127, -118.20560510711664),
createPoint(33.75470099272808, -118.2055621917724)
];

var pierG = [
createPoint(33.754950758302314, -118.20431764678949),
createPoint(33.752167615071166, -118.19856699066156),
createPoint(33.75191784138916, -118.19732244567865),
createPoint(33.75202488734198, -118.19594915466303),
createPoint(33.75152533841879, -118.1945758636474),

createPoint(33.74726121309604, -118.1900375659942),

createPoint(33.74649400486214, -118.1899839218139),
createPoint(33.74217610028443, -118.1899839218139),
createPoint(33.74178355272551, -118.19088514404291),
createPoint(33.74196198365682, -118.19161470489496),
createPoint(33.74303256144995, -118.19243009643549),
createPoint(33.74381764333901, -118.19247301177973),
createPoint(33.74670811017599, -118.19809492187494),
createPoint(33.74371058714093, -118.20358808593744),
createPoint(33.74470977312649, -118.20457513885492)
];

var harborScienic = [
createPoint(33.74706495117791, -118.18921144561762),
createPoint(33.73614494411756, -118.1852632339477),
createPoint(33.732861532934734, -118.1852632339477),
createPoint(33.73250463284381, -118.19667871551508),
createPoint(33.73614494411756, -118.20294435577387),
createPoint(33.739214106159544, -118.20448930816644),
createPoint(33.74071295934308, -118.20217187957758),
createPoint(33.740356091912936, -118.19539125518793),
createPoint(33.74303256144995, -118.19243009643549),
createPoint(33.74196198365682, -118.19161470489496),
createPoint(33.74178355272551, -118.19088514404291),
createPoint(33.74217610028443, -118.1899839218139),
createPoint(33.74649400486214, -118.1899839218139)
];

var john = [
createPoint(33.76874917552405, -118.2804234674681),
createPoint(33.76075760277206, -118.27574569494612),
createPoint(33.75619065520226, -118.2772906473387),
createPoint(33.75005343627797, -118.27364284307845),
createPoint(33.750481628597655, -118.27754813940413),
createPoint(33.749946387863965, -118.28085262091048),
createPoint(33.752265740247246, -118.28265506536849),
createPoint(33.75247983115056, -118.2838996103514),
createPoint(33.75158778219343, -118.28694659979232),
createPoint(33.75372868409881, -118.29003650457747),
createPoint(33.75613713484308, -118.28969118182357),
createPoint(33.759455333927704, -118.28634178497293),
createPoint(33.761025189810205, -118.28419601776102),
createPoint(33.765716746815684, -118.28136160504124)
]
//------------------------------------------------------
var tandc = [
createPoint(33.74169433712067, -118.26489265518182),
createPoint(33.739999222998115, -118.2646351631164),
createPoint(33.73741187896576, -118.26315458374017),
createPoint(33.73054165580861, -118.26263959960932),
createPoint(33.73400360324984, -118.24997957305902),
createPoint(33.73625200975805, -118.24407871322626),
createPoint(33.73891076363836, -118.24523742752069),
createPoint(33.74428155198661, -118.25167472915643),
createPoint(33.74961632107941, -118.25027998046869),
createPoint(33.751114992483245, -118.25180347518915),
createPoint(33.74428155198661, -118.25622375564569),
createPoint(33.74310393282772, -118.25851972656244),
createPoint(33.74367490171187, -118.26027925567621)
];

var seaSideFwy = [
createPoint(33.76000835462108, -118.23247702795385),
createPoint(33.76007971187001, -118.2302883453977),
createPoint(33.761292776013036, -118.22852881628393),
createPoint(33.762933953115756, -118.224580604614),
createPoint(33.76279124331086, -118.22243483740209),
createPoint(33.753942771349216, -118.21779998022436),
createPoint(33.75240846757555, -118.22294982153295),
createPoint(33.75679721693776, -118.22483809667943),
createPoint(33.7505173111945, -118.24642451483129),
createPoint(33.75501319958226, -118.24814112860082)
];

var eastChan = [
createPoint(33.71606777559191, -118.27720935897821),
createPoint(33.71792399529288, -118.26763923721307),
createPoint(33.72895339607076, -118.27233846740717),
createPoint(33.726918953016714, -118.28150089340204)
];

var berth = [
createPoint(33.75400521336313, -118.26611574249262),
createPoint(33.7593215380626, -118.26098735885614),
createPoint(33.76285367887967, -118.26148088531488),
createPoint(33.76444131091949, -118.2635193641662),
createPoint(33.76012431012036, -118.26326187210077)
];

var terminalIsland = [
createPoint(33.76731324471745, -118.2394223983764),
createPoint(33.7700602217674, -118.22691257553095),
createPoint(33.77043480272393, -118.22686966018671),
createPoint(33.771041263657835, -118.22504575805658),
createPoint(33.77205796794597, -118.22564657287592),
createPoint(33.77371677535748, -118.22566803054804),
createPoint(33.77940641911543, -118.2147460754394),
createPoint(33.78186765260286, -118.22034652786249),
createPoint(33.781600130649785, -118.22637613372797),
createPoint(33.77931724266137, -118.22895105438226),
createPoint(33.77690944330793, -118.23092516021723),
createPoint(33.775072336061086, -118.23693330841058),
createPoint(33.774947482682585, -118.23925073699945),
createPoint(33.77412701309693, -118.2399802978515),
createPoint(33.770523988424635, -118.24013050155634)
];

var school = [
createPoint(33.78810959427681, -118.10805852966303),
createPoint(33.78165363510723, -118.10810144500726),
createPoint(33.781617965472634, -118.11149175720209),
createPoint(33.78850192969818, -118.11595495300287)
]

var myHomeForTest = [
    createPoint(33.794507112296856, -118.03254361705774),
    createPoint(33.79469434952603, -118.03251679496759),
    createPoint(33.79469434952603, -118.03216274337763),
    createPoint(33.794520486398255, -118.03206618385309)
];


/**
 *    Fence In
 */ 

// SSA Terminals
// PIER A BERTHS A88-A96
var pierAFence = [
createPoint( 33.774478, -118.239286),
createPoint( 33.774503, -118.239427),
createPoint( 33.774120, -118.239525),
createPoint( 33.773934, -118.239673),
createPoint( 33.773451, -118.239674),
createPoint( 33.773199, -118.239476),
createPoint( 33.772996, -118.239130),
createPoint( 33.772707, -118.238636),
createPoint( 33.773001, -118.238333),
createPoint( 33.773115, -118.238453),
createPoint( 33.773786, -118.239342)
];

// Pacific Container Terminal
// PIER J
// 1521 Pier J Avenue, Long Beach, CA 90802
var pierJFence = [
createPoint( 33.740800, -118.189802),
createPoint( 33.740469, -118.189697),
createPoint( 33.740647, -118.189058),
createPoint( 33.740647, -118.188790),
createPoint( 33.740914, -118.187902),
createPoint( 33.741081, -118.187804),
createPoint( 33.741202, -118.187841),
createPoint( 33.742124, -118.188144),
createPoint( 33.742246, -118.188395),
createPoint( 33.742268, -118.188701),
// createPoint( 33.742163, -118.189836),
// createPoint( 33.741967, -118.189815),
// createPoint( 33.742068, -118.188878),
// createPoint( 33.741918, -118.188601),
createPoint( 33.741325, -118.188372),
createPoint( 33.741174, -118.188613),
createPoint( 33.741022, -118.189218)
]

// Long Beach Container Terminal
// PIER F BERTHS F6-F10
// 1171 Pier F Ave., Berth F10, Long Beach, CA 90802
var pierFFence = [
createPoint( 33.749915, -118.214341),
createPoint( 33.749778, -118.213692),
createPoint( 33.749430, -118.213737),
createPoint( 33.748918, -118.214207),
createPoint( 33.748806, -118.214482),
createPoint( 33.748373, -118.214605),
createPoint( 33.748129, -118.214484),
createPoint( 33.748192, -118.214339),
createPoint( 33.747969, -118.214365),
createPoint( 33.748066, -118.214736),
createPoint( 33.748220, -118.214844),
createPoint( 33.749909, -118.214422)
];


//International Transportation Service
//
var itsFence = [
createPoint( 33.745127, -118.191495),
createPoint( 33.745126, -118.191042),
// createPoint( 33.741720, -118.191129),
// createPoint( 33.741876, -118.191501),
createPoint( 33.743040, -118.190979),
createPoint( 33.742263, -118.191324),
createPoint( 33.742532, -118.191684)
]

//Hanjin
var ttiFence = [
createPoint( 33.760802, -118.224026),
createPoint( 33.761086, -118.223227),
createPoint( 33.758659, -118.221902),
createPoint( 33.758501, -118.222324),
createPoint( 33.758566, -118.222516),
createPoint( 33.759215, -118.223195)
];

var pierCFence = [
createPoint( 33.773428, -118.213571),
createPoint( 33.773181, -118.213432),
createPoint( 33.773542, -118.212526),
createPoint( 33.773537, -118.211921),
createPoint( 33.773620, -118.211669),
createPoint( 33.773710, -118.211713),
createPoint( 33.773631, -118.211911),
createPoint( 33.773767, -118.212608)
];



var stsFence = [
createPoint( 33.742384, -118.266831),
createPoint( 33.742605, -118.266290),
createPoint( 33.741844, -118.265885),
createPoint( 33.741596, -118.266422),
createPoint( 33.740636, -118.268783),
createPoint( 33.740843, -118.269366),
createPoint( 33.740859, -118.269452),
createPoint( 33.740805, -118.269543),
createPoint( 33.740694, -118.269578),
createPoint( 33.740394, -118.269419),
createPoint( 33.740328, -118.269575),
createPoint( 33.740683, -118.269750),
createPoint( 33.740864, -118.269701),
createPoint( 33.740995, -118.269553),
createPoint( 33.740979, -118.269270),
createPoint( 33.740886, -118.269012),
createPoint( 33.741543, -118.267220),
createPoint( 33.741931, -118.266600)
];

var emsFence = [ 
createPoint( 33.742660, -118.254553),
createPoint( 33.740925, -118.253778),
createPoint( 33.741081, -118.253187),
createPoint( 33.741863, -118.253522),
createPoint( 33.742162, -118.254006),
createPoint( 33.742770, -118.254317)
];

//Berths 401-406
//APM Terminals
// 2500 Navy Way
// Terminal Island, CA 90731
//(310) 221-4000
var apmTerminalFence = [
createPoint( 33.722332, -118.253631),
createPoint( 33.722746, -118.252195),
createPoint( 33.722779, -118.252146),
createPoint( 33.723512, -118.251840),
createPoint( 33.723542, -118.251947),
createPoint( 33.723411, -118.252008),
createPoint( 33.723291, -118.252156),
createPoint( 33.722799, -118.253820)
];


var westBasinFence = [
createPoint( 33.756158, -118.289156),
createPoint( 33.755871, -118.289078),
createPoint( 33.756030, -118.288510),
createPoint( 33.756020, -118.288440),
createPoint( 33.756053, -118.288316),
createPoint( 33.756042, -118.287970),
createPoint( 33.756148, -118.287747),
createPoint( 33.756665, -118.287263),
createPoint( 33.757180, -118.286118),
createPoint( 33.757221, -118.285278),
createPoint( 33.757378, -118.284898),
createPoint( 33.757840, -118.285208),
createPoint( 33.757818, -118.285571),
createPoint( 33.757897, -118.286429),
createPoint( 33.757865, -118.286635),
createPoint( 33.757530, -118.287470),
createPoint( 33.756391, -118.288266),
createPoint( 33.756178, -118.288761)
];

var yusenFence= [
createPoint( 33.756645, -118.253528),
createPoint( 33.756077, -118.253244),
createPoint( 33.757533, -118.248877),
createPoint( 33.757689, -118.248915),
createPoint( 33.757068, -118.250695),
createPoint( 33.757028, -118.250925),
createPoint( 33.757022, -118.251192),
createPoint( 33.757085, -118.251490),
createPoint( 33.757226, -118.251789),
createPoint( 33.757202, -118.251996)
];

var nextWestBasinFence = [
createPoint( 33.770113, -118.278725),
createPoint( 33.769239, -118.278567),
createPoint( 33.768471, -118.279952),
createPoint( 33.769325, -118.280108),
createPoint( 33.769836, -118.279512)];

var aboveApmFence = [
createPoint( 33.728913, -118.241525),
createPoint( 33.727942, -118.241123),
createPoint( 33.728451, -118.239380),
createPoint( 33.731427, -118.240593),
createPoint( 33.732348, -118.240144),
createPoint( 33.732716, -118.240300),
createPoint( 33.732700, -118.240447),
createPoint( 33.732377, -118.240326),
createPoint( 33.731444, -118.240818),
createPoint( 33.729649, -118.240086),
createPoint( 33.729463, -118.240041),
createPoint( 33.729324, -118.240144)
];

var schoolFence = [
createPoint(33.788564822335424, -118.10785404357898),
createPoint(33.78662096247371, -118.1078755012511),
createPoint(33.78662096247371, -118.10924879226673),
createPoint(33.78683496755591, -118.1092273345946),
createPoint(33.78681713381949, -118.10806862030017),
createPoint(33.78854698895927, -118.10804716262805)
];

var boundary =[seaSide, seaSideFwy, terminalIsland,berth,eastChan,
                         tandc,john,pierF,pierG, harborScienic, 
                         harry,ferry,pico,navywayIn, navywayOut,
                         school, myHomeForTest];

var fenceBoundary = [pierAFence,pierFFence,pierJFence,pierCFence,
                        itsFence,ttiFence,stsFence,emsFence,
                        apmTerminalFence, aboveApmFence,yusenFence,
                        westBasinFence,nextWestBasinFence, schoolFence];




var preboundary = [];
var boundaryAsGoogleMapPath = boundaryToGooleMapBoundary(boundary);
var fenceAsGoogleMapPath = boundaryToGooleMapBoundary(fenceBoundary);
console.log(boundaryAsGoogleMapPath);
createPreBoundary();

function arrayMin(arr) {
  var len = arr.length, min = Infinity;
  while (len--) {
    if (Number(arr[len]) < min) {
      min = Number(arr[len]);
    }
  }
  return min;
};

function arrayMax(arr) {
  var len = arr.length, max = -Infinity;
  while (len--) {
    if (Number(arr[len]) > max) {
      max = Number(arr[len]);
    }
  }
  return max;
};

function pointsToGoogleMapPath(points) {
    var temp = [];
    for(var i in points) {
        temp.push(new google.maps.LatLng(points[i].X, points[i].Y));
    }
    return temp;
}

function boundaryToGooleMapBoundary(boundary) {
    var temp = [];
    for(var i in boundary) {
        temp.push(pointsToGoogleMapPath(boundary[i]));
    }
    return temp;
}

function extractLatitudeInArray(array) {
    var arr = [];
    for(var i in array) {
        arr.push(array[i].X);
    }
    return arr;
}
function extractLongitudeInArray(array) {
var arr = [];
    for(var i in array) {
        arr.push(array[i].Y);
    }
    return arr;
}

//Executed Only Once
function createPreBoundary() {
    for(var i in boundary) {
        var lats = extractLatitudeInArray(boundary[i]);
        var longs = extractLongitudeInArray(boundary[i]);
        var minX = arrayMin(lats);
        var maxX = arrayMax(lats);
        var minY = arrayMin(longs);
        var maxY = arrayMax(longs);
        var bound = [];
        // bound.push(createPoint(minX,minY));
        // bound.push(createPoint(minX,maxY));
        // bound.push(createPoint(maxX,minY));
        // bound.push(createPoint(maxX,maxY));
        preboundary.push(createPreboundaryPoint(minX,maxX,minY,maxY));
    }
}

function createPreboundaryPoint(minX,maxX,minY,maxY) {
    var temp = { minX: minX, maxX: maxX, minY: minY, maxY: maxY };
    return temp;
}

function createPoint(x,y) {
    var temp = { X: x, Y: y };
    return temp;
}

/**
*   To do: Put logic to check preboundary and if passes, then check boundary.
*/
function checkData(data) {
    var point = createPoint(data.latitude, data.longitude);
    for(var i in boundary) {
       if(pointInPreBoundary(preboundary[i], point)) {
            if(pointInPolygon(boundary[i], point))
                return true;
       }
    }
    return false;
}

function pointInPreBoundary(preboundary, point) {
    if(preboundary.minX < points.X &&
        preboudnary.maxX > points.X &&
        preboundary.minY < points.Y &&
        preboundary.maxY > points.Y) {
        return true;
    }
    return false;
}

function pointInPolygon(listOfBoundaryPoints, point)
{
    var j = listOfBoundaryPoints.length - 1;
    var oddNodes = false;

    for (var i = 0; i < listOfBoundaryPoints.length; i++)
    {
        if (listOfBoundaryPoints[i].Y < point.Y && listOfBoundaryPoints[j].Y >= point.Y ||
            listOfBoundaryPoints[j].Y < point.Y && listOfBoundaryPoints[i].Y >= point.Y)
        {
        	//console.log("Checkin deno: " + listOfBoundaryPoints[j].Y - listOfBoundaryPoints[i].Y);
        	/**
        	 *     A - X1 		X2-X1
        	 *    ________  =  _______
        	 *
        	 *	   Y - y1       Y2-Y1
        	 */
            if (listOfBoundaryPoints[i].X +
                (point.Y - listOfBoundaryPoints[i].Y)/(listOfBoundaryPoints[j].Y - listOfBoundaryPoints[i].Y)*(listOfBoundaryPoints[j].X - listOfBoundaryPoints[i].X) < point.X)
            {
          //  	console.log("intersect: x1: " + listOfBoundaryPoints[i].X + " Ty: " + point.Y + 
          //  		" y1: " + listOfBoundaryPoints[i].Y  + " y2: " + listOfBoundaryPoints[j].Y + " x2: " + listOfBoundaryPoints[j].X);
                oddNodes = !oddNodes;
            }
        }
        j = i;
    }

    return oddNodes;
}
